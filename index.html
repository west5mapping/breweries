<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Breweries</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
        <script src="resources/leaflet.ajax.min.js"></script>
        <style>
            #header {
                height: 5vh;
                background-color: seagreen;
            }
            #mapdiv {
                height: 90vh;
                background-color: salmon;
            }
            #side_panel {
                height: 90vh;
                background-color: beige;
            }
            #footer {
                height: 5vh;
                background-color: darkgray;
            }
            .brewery {    
                margin-bottom: 5px;
            }
        </style>
    </head>
    <body>
        <div id="header" class="col-md-12">
            <h1 class="text-center"><strong>Calgary Craft Beer</strong></h1>
        </div>
        <div id="side_panel" class="col-md-2">
            <h1 class="text-center">Breweries</h1>
        </div>
        <div id="mapdiv" class="col-md-10"></div>
        <div id="footer" class="col-md-12">
            <h4 id ="map_coords" class="text-center">Latitude: 51 Longitude: -114 Zoom level: 10</h4>
            <h4 class="text-center">&copy;2017 <a href="http://www.west5mapping.com">West 5 Mapping Inc.</a></h4>
        </div>
        
        <script>
            var mapboxUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}';
            var accessToken = 'pk.eyJ1Ijoid2VzdDVtYXBwaW5nIiwiYSI6ImNpeW41ZXNiOTAwMW4zdXM3cGZteDkyOTYifQ.xNuwux36GPTjPkOIiFkF3Q';
            var mymap = L.map('mapdiv');
            mymap.setView([51, -114], 11);
            
            var backgroundLayer = L.tileLayer(mapboxUrl, {id: 'mapbox.streets', attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>', accessToken: accessToken});
            mymap.addLayer(backgroundLayer);
            
            
            var geojsonLayer = new L.GeoJSON.AJAX('data/breweries.geojson', {pointToLayer: function(feature, latlng){
                var but = "<button id='zoomTo"+feature.properties.Name.replace(/ /g, '');
                but += "' class ='form-control btn btn-primary brewery'>";
                but += feature.properties.Name+"</button>";
                $("#side_panel").append(but);
                $("#zoomTo"+feature.properties.Name.replace(/ /g, '')).click(function(){
                    mymap.setView([latlng.lat, latlng.lng], 17);
                });
                var str = "<h3 class='text-center'><strong>"+feature.properties.Name+"</strong></h3>";
                str += "<a href='"+feature.properties.Web+"' target ='blank'>";
                str += "<img src='img/"+feature.properties.Image+"' class='center-block' width='200px'>";
                str += "</a>";
                return L.marker(latlng).bindPopup(str);
            }});
            geojsonLayer.addTo(mymap);
            
            mymap.on('mousemove',function(e){
                     var coords = "Latitude: "+e.latlng.lat.toFixed(5)+"    Longitude: "+e.latlng.lng.toFixed(5)+"    Zoom Level: "+mymap.getZoom();
                     $("#map_coords").html(coords);
                     });
        </script>
    </body>
</html>